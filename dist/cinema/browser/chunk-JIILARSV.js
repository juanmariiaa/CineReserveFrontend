import{a as wt}from"./chunk-LUQKNZDT.js";import{a as Rt}from"./chunk-VZFPZPO5.js";import"./chunk-F5X5MWHG.js";import{c as ht,d as St}from"./chunk-MOW745QP.js";import{a as h,b as pt,c as ft,d as S,e as xt}from"./chunk-QUUHMHXX.js";import{a as Z,b as tt,c as et,d as nt,e as it,f as at,g as ot,h as rt,i as st,j as lt,k as mt,l as ct,m as dt,o as Ct}from"./chunk-KXWDHQ5G.js";import"./chunk-D26OFXL2.js";import"./chunk-J32DXLHF.js";import"./chunk-NSEFZZEN.js";import{a as K,b as W}from"./chunk-DDVV6NKZ.js";import{d as bt,e as Mt}from"./chunk-OQJFGUDZ.js";import{b as X,c as Y}from"./chunk-FCZTQVRE.js";import{D as _t,E as vt,t as G,v as ut,z as gt}from"./chunk-2FAWVZHA.js";import"./chunk-SZLBBELY.js";import{o as A,s as H}from"./chunk-NRVZBHM6.js";import{a as Q,c as q,g as J}from"./chunk-UTQDTBMQ.js";import{d as F,e as L,f as B,ga as U,ha as j,i as z,l as $,y as V}from"./chunk-BTJY3BD6.js";import{Db as c,Gb as k,Mb as i,Nb as a,Ob as g,Pb as p,Qb as f,Sb as b,Wb as M,Xb as d,ac as R,bc as w,cc as E,fb as r,fc as I,gc as o,ic as u,jc as T,kb as x,pc as N,qa as v,ra as C,rb as D,rc as O,tc as y,wb as m}from"./chunk-HKKO7SBW.js";var P=(l=>(l.PENDING="PENDING",l.CONFIRMED="CONFIRMED",l.CANCELLED="CANCELLED",l.COMPLETED="COMPLETED",l))(P||{});var Ot=()=>[5,10,25,100];function yt(n,e){n&1&&(i(0,"div",10),g(1,"mat-spinner"),a())}function Pt(n,e){if(n&1){let t=b();i(0,"button",35),M("click",function(){let l=v(t).$implicit,_=d(2);return C(_.toggleStatusFilter(l))}),o(1),a()}if(n&2){let t=e.$implicit,s=d(2);k("status-filter-btn "+s.getFilterButtonClass(t)),r(),u(" ",t.label," ")}}function Dt(n,e){n&1&&(i(0,"th",36),o(1,"ID"),a())}function kt(n,e){if(n&1&&(i(0,"td",37),o(1),a()),n&2){let t=e.$implicit;r(),u(" ",t.id," ")}}function It(n,e){n&1&&(i(0,"th",36),o(1,"User"),a())}function Tt(n,e){if(n&1&&(i(0,"td",37),o(1),a()),n&2){let t=e.$implicit;r(),u(" ",(t.user==null?null:t.user.username)||"Unknown"," ")}}function Nt(n,e){n&1&&(i(0,"th",36),o(1,"Movie"),a())}function Ft(n,e){if(n&1&&(i(0,"td",37),o(1),a()),n&2){let t=e.$implicit;r(),u(" ",(t.screening==null||t.screening.movie==null?null:t.screening.movie.title)||"Unknown"," ")}}function Lt(n,e){n&1&&(i(0,"th",36),o(1,"Date"),a())}function Bt(n,e){if(n&1&&(i(0,"td",37),o(1),O(2,"date"),a()),n&2){let t=e.$implicit;r(),u(" ",y(2,1,t.reservationDate,"dd/MM/yyyy HH:mm")," ")}}function zt(n,e){n&1&&(i(0,"th",36),o(1," Screening "),a())}function $t(n,e){if(n&1&&(i(0,"td",37),o(1),O(2,"date"),a()),n&2){let t=e.$implicit;r(),T(" ",y(2,2,t.screening==null?null:t.screening.date,"dd/MM/yyyy")," ",t.screening==null?null:t.screening.startTime," ")}}function Vt(n,e){n&1&&(i(0,"th",38),o(1,"Seats"),a())}function At(n,e){if(n&1&&(i(0,"span",40),o(1),a()),n&2){let t=d().$implicit;r(),u(" ",t.seatReservations.length," seats ")}}function Ht(n,e){n&1&&(i(0,"span"),o(1,"-"),a())}function Ut(n,e){if(n&1&&(i(0,"td",37),m(1,At,2,1,"span",39)(2,Ht,2,0,"span",9),a()),n&2){let t=e.$implicit;r(),c("ngIf",t.seatReservations==null?null:t.seatReservations.length),r(),c("ngIf",!(t.seatReservations!=null&&t.seatReservations.length))}}function jt(n,e){n&1&&(i(0,"th",36),o(1,"Status"),a())}function Gt(n,e){if(n&1&&(i(0,"td",37)(1,"span",41),o(2),a()()),n&2){let t=e.$implicit,s=d(2);r(),c("ngClass",s.getStatusClass(t.status)),r(),u(" ",s.getStatusLabel(t.status)," ")}}function Qt(n,e){n&1&&(i(0,"th",38),o(1,"Actions"),a())}function qt(n,e){if(n&1){let t=b();i(0,"td",37)(1,"button",42),M("click",function(){let l=v(t).$implicit,_=d(2);return C(_.confirmCancel(l))}),i(2,"mat-icon"),o(3,"cancel"),a(),o(4," Cancel "),a()()}if(n&2){let t=e.$implicit,s=d(2);r(),c("disabled",t.status===s.ReservationStatus.CANCELLED||t.status===s.ReservationStatus.COMPLETED)}}function Jt(n,e){n&1&&g(0,"tr",43)}function Kt(n,e){n&1&&g(0,"tr",44)}function Wt(n,e){if(n&1&&(i(0,"tr",45)(1,"td",46),o(2),a()()),n&2){d();let t=I(5);r(2),u(' No reservations found matching "',t.value,'" ')}}function Xt(n,e){if(n&1){let t=b();i(0,"div")(1,"mat-form-field",11)(2,"mat-label"),o(3,"Filter reservations"),a(),i(4,"input",12,0),M("keyup",function(l){v(t);let _=d();return C(_.applyFilter(l))}),a(),i(6,"mat-icon",13),o(7,"search"),a()(),i(8,"div",14)(9,"span",15),o(10,"Filter by status:"),a(),i(11,"div",16),m(12,Pt,2,3,"button",17),a()(),i(13,"div",18)(14,"table",19),p(15,20),m(16,Dt,2,0,"th",21)(17,kt,2,1,"td",22),f(),p(18,23),m(19,It,2,0,"th",21)(20,Tt,2,1,"td",22),f(),p(21,24),m(22,Nt,2,0,"th",21)(23,Ft,2,1,"td",22),f(),p(24,25),m(25,Lt,2,0,"th",21)(26,Bt,3,4,"td",22),f(),p(27,26),m(28,zt,2,0,"th",21)(29,$t,3,5,"td",22),f(),p(30,27),m(31,Vt,2,0,"th",28)(32,Ut,3,2,"td",22),f(),p(33,29),m(34,jt,2,0,"th",21)(35,Gt,3,2,"td",22),f(),p(36,30),m(37,Qt,2,0,"th",28)(38,qt,5,1,"td",22),f(),m(39,Jt,1,0,"tr",31)(40,Kt,1,0,"tr",32)(41,Wt,3,1,"tr",33),a(),g(42,"mat-paginator",34),a()()}if(n&2){let t=d();r(12),c("ngForOf",t.statusOptions),r(2),c("dataSource",t.dataSource),r(25),c("matHeaderRowDef",t.displayedColumns),r(),c("matRowDefColumns",t.displayedColumns),r(2),c("pageSizeOptions",N(5,Ot))}}var Et=class n{constructor(e,t,s){this.reservationService=e;this.snackBar=t;this.dialog=s}paginator;sort;reservations=[];loading=!0;displayedColumns=["id","user","movie","date","screening","seats","status","actions"];dataSource=new dt([]);ReservationStatus=P;initialized=!1;statusOptions=[{value:"PENDING",label:"Pending",selected:!0,color:"warn"},{value:"CONFIRMED",label:"Confirmed",selected:!0,color:"primary"},{value:"CANCELLED",label:"Cancelled",selected:!0,color:"warn"}];ngOnInit(){this.loadReservations()}ngAfterViewInit(){this.initialized||(this.dataSource.paginator=this.paginator,this.dataSource.sort=this.sort,this.initialized=!0)}loadReservations(){this.loading=!0,this.reservationService.getAllReservations().subscribe({next:e=>{this.reservations=e,this.dataSource.data=e,this.paginator&&(this.dataSource.paginator=this.paginator),this.sort&&(this.dataSource.sort=this.sort),this.filterByStatus(),this.loading=!1},error:e=>{this.snackBar.open("Failed to load reservations: "+e.message,"Close",{duration:5e3}),this.loading=!1}})}applyFilter(e){let t=e.target.value;this.dataSource.filter=t.trim().toLowerCase()}toggleStatusFilter(e){e&&typeof e.selected=="boolean"&&(e.selected=!e.selected,this.filterByStatus())}filterByStatus(){let e=this.statusOptions.filter(t=>t.selected).map(t=>t.value);e.length===0?this.dataSource.data=[...this.reservations]:this.dataSource.data=this.reservations.filter(t=>e.includes(t.status)),this.dataSource.paginator&&this.dataSource.paginator.firstPage()}getStatusLabel(e){switch(e){case"PENDING":return"Pending";case"CONFIRMED":return"Confirmed";case"CANCELLED":return"Cancelled";default:return"Unknown"}}getStatusClass(e){switch(e){case"PENDING":return"status-pending";case"CONFIRMED":return"status-confirmed";case"CANCELLED":return"status-cancelled";default:return""}}getFilterButtonClass(e){let t=e.selected?"selected":"unselected";switch(e.value){case"PENDING":return`${t} filter-pending`;case"CONFIRMED":return`${t} filter-confirmed`;case"CANCELLED":return`${t} filter-cancelled`;default:return t}}getFilterIcon(e){return""}confirmCancel(e){confirm(`Are you sure you want to cancel reservation #${e.id}?`)&&this.cancelReservation(e.id)}cancelReservation(e){this.reservationService.cancelReservation(e).subscribe({next:()=>{this.snackBar.open("Reservation cancelled successfully","Close",{duration:3e3}),this.loadReservations()},error:t=>{this.snackBar.open("Error cancelling reservation: "+t.message,"Close",{duration:5e3})}})}static \u0275fac=function(t){return new(t||n)(x(wt),x(X),x(ht))};static \u0275cmp=D({type:n,selectors:[["app-reservation-management"]],viewQuery:function(t,s){if(t&1&&(R(S,5),R(h,5)),t&2){let l;w(l=E())&&(s.paginator=l.first),w(l=E())&&(s.sort=l.first)}},decls:15,vars:2,consts:[["input",""],[1,"reservation-management-container"],[1,"dashboard-title-container"],[1,"dashboard-title-marker"],[1,"dashboard-title"],[1,"action-bar"],["mat-raised-button","","routerLink","/admin/dashboard",1,"back-button"],[1,"table-card"],["class","loading-spinner",4,"ngIf"],[4,"ngIf"],[1,"loading-spinner"],["appearance","outline",1,"filter-field"],["matInput","","placeholder","User, movie, status...",3,"keyup"],["matSuffix",""],[1,"status-filter-container"],[1,"filter-label"],[1,"status-filter-buttons"],["mat-button","",3,"class","click",4,"ngFor","ngForOf"],[1,"table-container"],["mat-table","","matSort","",1,"reservation-table",3,"dataSource"],["matColumnDef","id"],["mat-header-cell","","mat-sort-header","",4,"matHeaderCellDef"],["mat-cell","",4,"matCellDef"],["matColumnDef","user"],["matColumnDef","movie"],["matColumnDef","date"],["matColumnDef","screening"],["matColumnDef","seats"],["mat-header-cell","",4,"matHeaderCellDef"],["matColumnDef","status"],["matColumnDef","actions"],["mat-header-row","",4,"matHeaderRowDef"],["mat-row","",4,"matRowDef","matRowDefColumns"],["class","mat-row",4,"matNoDataRow"],["aria-label","Select reservation page",3,"pageSizeOptions"],["mat-button","",3,"click"],["mat-header-cell","","mat-sort-header",""],["mat-cell",""],["mat-header-cell",""],["class","seats-count",4,"ngIf"],[1,"seats-count"],[3,"ngClass"],["mat-raised-button","","color","warn",1,"cancel-button",3,"click","disabled"],["mat-header-row",""],["mat-row",""],[1,"mat-row"],["colspan","8",1,"mat-cell"]],template:function(t,s){t&1&&(i(0,"div",1)(1,"div",2),g(2,"div",3),i(3,"h1",4),o(4,"Reservation Management"),a()(),i(5,"div",5),g(6,"div"),i(7,"button",6)(8,"mat-icon"),o(9,"arrow_back"),a(),o(10," Back to Dashboard "),a()(),i(11,"mat-card",7)(12,"mat-card-content"),m(13,yt,2,0,"div",8)(14,Xt,43,6,"div",9),a()()()),t&2&&(r(13),c("ngIf",s.loading),r(),c("ngIf",!s.loading))},dependencies:[$,F,L,B,z,V,J,Q,q,H,A,j,U,W,K,Y,ct,Z,et,ot,nt,tt,rt,it,at,st,lt,mt,ft,h,pt,xt,S,Mt,bt,_t,ut,gt,vt,St,G,Ct,Rt],styles:[".reservation-management-container[_ngcontent-%COMP%]{padding:20px;color:#fff;background-color:transparent;min-height:100vh}.dashboard-title-container[_ngcontent-%COMP%]{display:flex;align-items:center;margin-bottom:20px}.dashboard-title-marker[_ngcontent-%COMP%]{width:5px;height:30px;background-color:#ff6b6b;margin-right:10px;border-radius:3px}.dashboard-title[_ngcontent-%COMP%]{margin:0;font-size:24px;font-weight:500;color:#fff}.action-bar[_ngcontent-%COMP%]{display:flex;justify-content:space-between;margin-bottom:20px;gap:10px}.back-button[_ngcontent-%COMP%]{background-color:#444!important;color:#fff!important;transition:background-color .3s ease}.back-button[_ngcontent-%COMP%]:hover{background-color:#555!important}.table-card[_ngcontent-%COMP%]{border-radius:8px;background-color:#222;margin-bottom:20px;overflow:hidden;box-shadow:0 4px 8px #0000004d}.cancel-button[_ngcontent-%COMP%]{background-color:#ff6b6b!important;color:#fff!important;transition:background-color .3s ease;padding:0 12px}.cancel-button[_ngcontent-%COMP%]:hover{background-color:#ff5252!important}.cancel-button[_ngcontent-%COMP%]:disabled{background-color:#ff6b6b80!important;color:#ffffff80!important}.status-filter-container[_ngcontent-%COMP%]{display:flex;align-items:center;margin-bottom:16px;flex-wrap:wrap;gap:10px}.filter-label[_ngcontent-%COMP%]{font-weight:500;margin-right:8px;color:#fff}.status-filter-buttons[_ngcontent-%COMP%]{display:flex;flex-wrap:wrap;gap:8px}.status-filter-btn[_ngcontent-%COMP%]{padding:8px 16px!important;border-radius:16px!important;font-weight:500!important;font-size:13px!important;border:1px solid transparent!important;transition:all .2s ease!important;text-transform:none!important;min-width:110px!important;height:36px!important}.status-filter-btn.unselected[_ngcontent-%COMP%]{background-color:#ffffff14!important;color:#fff9!important;border-color:#ffffff26!important}.status-filter-btn.unselected[_ngcontent-%COMP%]:hover{background-color:#ffffff1f!important;color:#fffc!important}.status-filter-btn.selected.filter-pending[_ngcontent-%COMP%]{background-color:#8b6f47!important;color:#fff4e6!important;border-color:#6b5538!important;box-shadow:0 2px 6px #8b6f4740!important}.status-filter-btn.selected.filter-pending[_ngcontent-%COMP%]:hover{background-color:#7a6240!important}.status-filter-btn.selected.filter-confirmed[_ngcontent-%COMP%]{background-color:#5a7c42!important;color:#f0f8e8!important;border-color:#4a6b35!important;box-shadow:0 2px 6px #5a7c4240!important}.status-filter-btn.selected.filter-confirmed[_ngcontent-%COMP%]:hover{background-color:#4f6b3a!important}.status-filter-btn.selected.filter-cancelled[_ngcontent-%COMP%]{background-color:#8b5a5a!important;color:#fdf0f0!important;border-color:#6b4545!important;box-shadow:0 2px 6px #8b5a5a40!important}.status-filter-btn.selected.filter-cancelled[_ngcontent-%COMP%]:hover{background-color:#7a5050!important}.status-pending[_ngcontent-%COMP%]{color:#fff4e6;font-weight:500;padding:6px 12px;border-radius:16px;background-color:#8b6f47;border:1px solid #6b5538;text-shadow:none;display:inline-flex;align-items:center;font-size:12px;text-transform:capitalize;letter-spacing:.3px}.status-confirmed[_ngcontent-%COMP%]{color:#f0f8e8;font-weight:500;padding:6px 12px;border-radius:16px;background-color:#5a7c42;border:1px solid #4a6b35;text-shadow:none;display:inline-flex;align-items:center;font-size:12px;text-transform:capitalize;letter-spacing:.3px}.status-cancelled[_ngcontent-%COMP%]{color:#fdf0f0;font-weight:500;padding:6px 12px;border-radius:16px;background-color:#8b5a5a;border:1px solid #6b4545;text-shadow:none;display:inline-flex;align-items:center;font-size:12px;text-transform:capitalize;letter-spacing:.3px}.loading-spinner[_ngcontent-%COMP%]{display:flex;justify-content:center;padding:30px}.filter-field[_ngcontent-%COMP%]{width:100%;margin-bottom:16px}.status-filters[_ngcontent-%COMP%]{margin-bottom:20px}.table-container[_ngcontent-%COMP%]{overflow-x:auto}.reservation-table[_ngcontent-%COMP%]{width:100%}.seats-count[_ngcontent-%COMP%]{background-color:#ff6b6b33;color:#fff;padding:3px 8px;border-radius:12px;font-size:12px}.status-chip[_ngcontent-%COMP%]{padding:3px 8px;border-radius:12px;font-size:12px;display:inline-block;color:#fff}.status-pending[_ngcontent-%COMP%], .status-confirmed[_ngcontent-%COMP%], .status-cancelled[_ngcontent-%COMP%]{transition:opacity .2s ease}.status-pending[_ngcontent-%COMP%]:hover, .status-confirmed[_ngcontent-%COMP%]:hover, .status-cancelled[_ngcontent-%COMP%]:hover{opacity:.9}  .mat-mdc-form-field-label{color:#fff9!important}  .mat-mdc-input-element{color:#fff!important}  .mat-sort-header-content{color:#fff!important}  .mat-mdc-paginator-range-label,   .mat-mdc-paginator-page-size-label{color:#fff!important}  .mat-mdc-select-value,   .mat-mdc-select-arrow{color:#fff!important}  .mat-mdc-table .mat-mdc-header-cell{color:#ffffffde!important;background-color:#202020!important}  .mat-mdc-table .mat-mdc-cell{color:#fff!important}  .mat-mdc-card-content{color:#fff!important}@media (max-width: 768px){.status-filter-container[_ngcontent-%COMP%]{flex-direction:column;align-items:flex-start;gap:12px}.status-filter-buttons[_ngcontent-%COMP%]{width:100%;justify-content:center}.status-filter-btn[_ngcontent-%COMP%]{min-width:100px!important;font-size:12px!important}}@media (max-width: 480px){.status-filter-buttons[_ngcontent-%COMP%]{flex-direction:column;width:100%}.status-filter-btn[_ngcontent-%COMP%]{width:100%!important;min-width:unset!important}}"]})};export{Et as ReservationManagementComponent};
