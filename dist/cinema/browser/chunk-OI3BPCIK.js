import{c as F,d as C,f as b,i as S}from"./chunk-X4G2UA5K.js";import{a as N,b as we,c as Pe,g as Ie,h as Ee,i as Ne,j as Te,k as Ae,l as Le,m as Re,n as D,p as ie,q as ne}from"./chunk-MXZSFMVO.js";import{a as A,b as L}from"./chunk-HGZD7DPT.js";import{d as ee,e as te}from"./chunk-LUQUAHTJ.js";import{b as R}from"./chunk-BAFH5YR6.js";import{D as X,E as Z,c as z,e as v,g as q,h as U,k as Y,n as H,o as W,s as $,u as J,v as K,w as Q}from"./chunk-Z5HG6CM3.js";import{m as V,o as T,s as P}from"./chunk-A4IL2YBM.js";import{f as y,ga as j,ha as I,l as w,x as G,y as Oe,z as ye}from"./chunk-DWWDMUIZ.js";import{Ba as x,Db as m,Fb as be,Mb as n,N as he,Nb as i,Ob as d,Pb as ve,Qb as xe,Sb as M,Wb as c,Xb as f,Yb as Me,Zb as Ce,a as fe,b as ge,eb as _e,fb as l,fc as Se,gc as o,hc as O,kb as u,pc as ke,qa as h,ra as _,rb as k,wb as p}from"./chunk-HQVUQXPE.js";var ze=["*"];function qe(r,a){if(r&1){let e=M();n(0,"div",1),c("click",function(s){h(e);let g=f();return _(g.onBackdropClick(s))}),n(1,"div",2)(2,"div",3)(3,"h2"),o(4),i(),n(5,"button",4),c("click",function(){h(e);let s=f();return _(s.close.emit())}),n(6,"mat-icon"),o(7,"close"),i()()(),n(8,"div",5),Ce(9),i()()()}if(r&2){let e=f();m("@fadeInOut",void 0),l(),m("@slideInOut",void 0),l(3),O(e.title)}}var B=class r{title="";isOpen=!1;close=new x;onBackdropClick(a){a.target.classList.contains("modal-backdrop")&&this.close.emit()}static \u0275fac=function(e){return new(e||r)};static \u0275cmp=k({type:r,selectors:[["app-modal"]],inputs:{title:"title",isOpen:"isOpen"},outputs:{close:"close"},ngContentSelectors:ze,decls:1,vars:1,consts:[["class","modal-backdrop",3,"click",4,"ngIf"],[1,"modal-backdrop",3,"click"],[1,"modal-container"],[1,"modal-header"],["mat-icon-button","",1,"close-button",3,"click"],[1,"modal-content"]],template:function(e,t){e&1&&(Me(),p(0,qe,10,3,"div",0)),e&2&&m("ngIf",t.isOpen)},dependencies:[w,y,P,V,I,j],styles:[".modal-backdrop[_ngcontent-%COMP%]{position:fixed;top:0;left:0;width:100%;height:100%;background-color:#0009;-webkit-backdrop-filter:blur(4px);backdrop-filter:blur(4px);display:flex;justify-content:center;align-items:center;z-index:1050;padding:20px;box-sizing:border-box}.modal-container[_ngcontent-%COMP%]{background-color:#35342e;border-radius:12px;box-shadow:0 8px 24px #00000040;width:100%;max-width:450px;max-height:90vh;display:flex;flex-direction:column;overflow:hidden;color:#fff}.modal-header[_ngcontent-%COMP%]{display:flex;justify-content:space-between;align-items:center;padding:16px 24px;border-bottom:1px solid rgba(255,255,255,.1);flex-shrink:0}.modal-header[_ngcontent-%COMP%]   h2[_ngcontent-%COMP%]{margin:0;font-size:1.5rem;font-weight:500;color:#fff}.close-button[_ngcontent-%COMP%]{color:#ffffffb3;transition:color .2s}.close-button[_ngcontent-%COMP%]:hover{color:#fff}.modal-content[_ngcontent-%COMP%]{padding:24px;overflow-y:auto;flex-grow:1;-webkit-overflow-scrolling:touch}@media (max-width: 600px){.modal-container[_ngcontent-%COMP%]{height:100%;max-width:100%;max-height:100%;border-radius:0}.modal-backdrop[_ngcontent-%COMP%]{padding:0}.modal-content[_ngcontent-%COMP%]{padding:16px}}"],data:{animation:[F("fadeInOut",[S(":enter",[b({opacity:0}),C("200ms ease-in",b({opacity:1}))]),S(":leave",[C("150ms ease-out",b({opacity:0}))])]),F("slideInOut",[S(":enter",[b({transform:"translateY(-20px)",opacity:0}),C("250ms ease-out",b({transform:"translateY(0)",opacity:1}))]),S(":leave",[C("200ms ease-in",b({transform:"translateY(-20px)",opacity:0}))])])]}})};function We(r,a){r&1&&(n(0,"mat-error"),o(1,"Username is required"),i())}function $e(r,a){r&1&&(n(0,"mat-error"),o(1,"Password is required"),i())}var oe=class r{constructor(a,e,t,s,g){this.fb=a;this.authService=e;this.router=t;this.snackBar=s;this.socialAuthService=g;this.loginForm=this.fb.group({username:["",v.required],password:["",v.required]}),this.authStatusSub=this.socialAuthService.authState.subscribe(E=>{E&&E.idToken&&this.isOpen&&!this.authService.isLoggedIn()&&!this.isProcessingGoogleAuth&&(this.isProcessingGoogleAuth=!0,this.handleGoogleSignIn(E.idToken))})}isOpen=!1;close=new x;switchToRegister=new x;loginSuccess=new x;loginForm;authStatusSub;isProcessingGoogleAuth=!1;ngOnDestroy(){this.authStatusSub&&this.authStatusSub.unsubscribe(),this.isProcessingGoogleAuth=!1}onLogin(){if(this.loginForm.valid){let{username:a,password:e}=this.loginForm.value;this.authService.login({username:a,password:e}).subscribe({next:()=>{this.loginForm.reset(),this.close.emit(),this.loginSuccess.emit(),this.authService.isAdmin()&&this.router.navigate(["/admin/dashboard"]),this.snackBar.open("Login successful!","Close",{duration:3e3})},error:t=>{let s="Invalid username or password";t.status===401?s="Invalid username or password":t.status===0?s="Could not connect to server. Please check your connection.":t.error&&typeof t.error=="string"?s=t.error:t.error&&t.error.message?s=t.error.message:t.status>=500&&(s="Server error. Please try again later."),this.snackBar.open(s,"Close",{duration:5e3,panelClass:["error-snackbar"]})}})}}handleGoogleSignIn(a){this.authService.loginWithGoogle(a).pipe(he(()=>{this.isProcessingGoogleAuth=!1})).subscribe({next:e=>{this.close.emit(),this.loginSuccess.emit(),this.authService.isAdmin()?this.router.navigate(["/admin/dashboard"]):this.router.navigate(["/"]),this.snackBar.open("Google sign-in successful!","Close",{duration:3e3})},error:e=>{console.error("Google auth error:",e);let t="Google authentication failed";e.status===401?t="Google authentication failed. Please try again.":e.status===0?t="Could not connect to server. Please check your connection.":e.status===409?t="Account created successfully! Please try signing in again.":e.error&&typeof e.error=="string"?t=e.error:e.error&&e.error.message&&typeof e.error.message=="string"?t=e.error.message:e.status>=500&&(t="Server error. Please try again later."),this.isNewUserError(e)&&(setTimeout(()=>{this.socialAuthService.signIn(Re.PROVIDER_ID)},1500),t="Welcome! Your account has been created. Signing you in now..."),this.snackBar.open(t,"Close",{duration:5e3,panelClass:["error-snackbar"]})}})}isNewUserError(a){if(!a||a.status!==400)return!1;if(typeof a.error=="string"){let e=a.error.toLowerCase();return e.includes("user not found")||e.includes("first time")||e.includes("registration")}if(a.error&&typeof a.error.message=="string"){let e=a.error.message.toLowerCase();return e.includes("user not found")||e.includes("first time")||e.includes("registration")}return!1}onModalClose(){this.isProcessingGoogleAuth=!1,this.close.emit()}static \u0275fac=function(e){return new(e||r)(u($),u(N),u(G),u(R),u(D))};static \u0275cmp=k({type:r,selectors:[["app-login-modal"]],inputs:{isOpen:"isOpen"},outputs:{close:"close",switchToRegister:"switchToRegister",loginSuccess:"loginSuccess"},decls:28,vars:6,consts:[[3,"close","isOpen","title"],[3,"ngSubmit","formGroup"],[1,"form-field-container"],["appearance","outline",1,"full-width"],["matInput","","formControlName","username","placeholder","Username"],[4,"ngIf"],["matInput","","type","password","formControlName","password","placeholder","Password"],[1,"form-actions"],["type","submit","mat-raised-button","","color","accent",1,"action-button",3,"disabled"],[1,"divider"],[1,"social-login-container"],[1,"social-login-text"],[1,"google-signin-options"],["type","standard","size","medium"],[1,"register-link"],["mat-button","","color","primary",1,"link-button",3,"click"]],template:function(e,t){if(e&1&&(n(0,"app-modal",0),c("close",function(){return t.onModalClose()}),n(1,"form",1),c("ngSubmit",function(){return t.onLogin()}),n(2,"div",2)(3,"mat-form-field",3)(4,"mat-label"),o(5,"Username"),i(),d(6,"input",4),p(7,We,2,0,"mat-error",5),i(),n(8,"mat-form-field",3)(9,"mat-label"),o(10,"Password"),i(),d(11,"input",6),p(12,$e,2,0,"mat-error",5),i()(),n(13,"div",7)(14,"button",8),o(15," Login "),i()()(),d(16,"mat-divider",9),n(17,"div",10)(18,"p",11),o(19,"Or sign in with:"),i(),n(20,"div",12),d(21,"asl-google-signin-button",13),i()(),d(22,"mat-divider",9),n(23,"div",14)(24,"p"),o(25,"Don't have an account?"),i(),n(26,"button",15),c("click",function(){return t.switchToRegister.emit()}),o(27,"Register now"),i()()()),e&2){let s,g;m("isOpen",t.isOpen)("title","Login"),l(),m("formGroup",t.loginForm),l(6),m("ngIf",(s=t.loginForm.get("username"))==null?null:s.hasError("required")),l(5),m("ngIf",(g=t.loginForm.get("password"))==null?null:g.hasError("required")),l(2),m("disabled",t.loginForm.invalid)}},dependencies:[w,y,J,Y,z,q,U,H,W,Z,X,K,Q,te,ee,P,T,I,L,A,ne,ie,B],styles:["[_nghost-%COMP%]     .mat-mdc-form-field{display:block;margin-bottom:24px}[_nghost-%COMP%]     .mat-mdc-form-field-subscript-wrapper{height:auto!important;position:static!important}[_nghost-%COMP%]     .mat-mdc-form-field-infix{min-height:40px;padding-top:12px!important;padding-bottom:8px!important}[_nghost-%COMP%]     .mat-mdc-text-field-wrapper{background-color:#ffffff0f;height:auto}[_nghost-%COMP%]     .mat-mdc-form-field-flex{margin-top:0}[_nghost-%COMP%]     .mdc-notched-outline{z-index:0}[_nghost-%COMP%]     .mdc-text-field--outlined .mdc-notched-outline__leading, [_nghost-%COMP%]     .mdc-text-field--outlined .mdc-notched-outline__notch, [_nghost-%COMP%]     .mdc-text-field--outlined .mdc-notched-outline__trailing{border-color:#fff3}[_nghost-%COMP%]     .mdc-text-field:not(.mdc-text-field--disabled) .mdc-floating-label{color:#ffffffb3}[_nghost-%COMP%]     .mat-mdc-input-element{color:#fff}[_nghost-%COMP%]     .mat-mdc-form-field-error{margin-top:6px}[_nghost-%COMP%]     .mdc-text-field--outlined:not(.mdc-text-field--disabled).mdc-text-field--focused .mdc-notched-outline__leading, [_nghost-%COMP%]     .mdc-text-field--outlined:not(.mdc-text-field--disabled).mdc-text-field--focused .mdc-notched-outline__notch, [_nghost-%COMP%]     .mdc-text-field--outlined:not(.mdc-text-field--disabled).mdc-text-field--focused .mdc-notched-outline__trailing{border-color:#ff6b6b}.form-field-container[_ngcontent-%COMP%]{margin-bottom:16px}.full-width[_ngcontent-%COMP%]{width:100%}.form-actions[_ngcontent-%COMP%]{display:flex;justify-content:center;margin-top:20px;margin-bottom:16px}[_nghost-%COMP%]     .action-button{width:100%;height:44px;font-weight:500;background-color:#ff6b6b!important;color:#fff!important;border-radius:8px!important;padding:0 16px;box-shadow:0 3px 5px #0003;transition:all .2s ease}[_nghost-%COMP%]     .action-button:hover:not([disabled]){background-color:#ff5252!important;box-shadow:0 4px 8px #0000004d;transform:translateY(-1px)}[_nghost-%COMP%]     .action-button:disabled{background-color:#ff6b6b80!important;color:#fff9!important}[_nghost-%COMP%]     .link-button{color:#ff6b6b!important;font-weight:500}[_nghost-%COMP%]     .link-button:hover{background-color:#ff6b6b1a}.divider[_ngcontent-%COMP%]{margin:16px 0;background-color:#ffffff1a}.social-login-container[_ngcontent-%COMP%]{display:flex;flex-direction:column;align-items:center;margin:16px 0}.social-login-text[_ngcontent-%COMP%]{font-size:14px;color:#ffffffb3;margin-bottom:12px;text-align:center}.google-signin-options[_ngcontent-%COMP%]{display:flex;justify-content:center;width:100%}.register-link[_ngcontent-%COMP%]{display:flex;flex-direction:column;align-items:center;margin-top:8px}.register-link[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{font-size:14px;color:#ffffffb3;margin-bottom:8px}"]})};function Je(r,a){r&1&&(n(0,"mat-error"),o(1," First name is required "),i())}function Ke(r,a){r&1&&(n(0,"mat-error"),o(1," Last name is required "),i())}function Qe(r,a){r&1&&(n(0,"mat-error"),o(1," Username is required "),i())}function Xe(r,a){r&1&&(n(0,"mat-error"),o(1," Email is required "),i())}function Ze(r,a){r&1&&(n(0,"mat-error"),o(1," Please enter a valid email address "),i())}function et(r,a){r&1&&(n(0,"mat-error"),o(1," Password is required "),i())}function tt(r,a){r&1&&(n(0,"mat-error"),o(1," Password must be at least 6 characters "),i())}var re=class r{constructor(a,e,t,s){this.fb=a;this.authService=e;this.snackBar=t;this.socialAuthService=s;this.registerForm=this.fb.group({firstName:["",v.required],lastName:["",v.required],username:["",v.required],email:["",[v.required,v.email]],password:["",[v.required,v.minLength(6)]],phoneNumber:[""]}),this.authStatusSub=this.socialAuthService.authState.subscribe(g=>{g&&g.idToken&&this.isOpen&&!this.authService.isLoggedIn()&&!this.isProcessingGoogleAuth&&(this.isProcessingGoogleAuth=!0,this.handleGoogleSignUp(g.idToken))})}isOpen=!1;close=new x;switchToLogin=new x;registerSuccess=new x;registerForm;authStatusSub;isProcessingGoogleAuth=!1;ngOnDestroy(){this.authStatusSub&&this.authStatusSub.unsubscribe(),this.isProcessingGoogleAuth=!1}onRegister(){if(this.registerForm.valid){let a=ge(fe({},this.registerForm.value),{roles:["user"]});this.authService.register(a).subscribe({next:()=>{this.registerForm.reset(),this.registerSuccess.emit(),this.switchToLogin.emit(),this.snackBar.open("Registration successful! Please login.","Close",{duration:3e3})},error:e=>{let t="Registration failed";e.status===409?t="Username or email already exists":e.status===400?t="Invalid registration data. Please check your information.":e.status===0?t="Could not connect to server. Please check your connection.":e.error&&typeof e.error=="string"?t=e.error:e.error&&e.error.message?t=e.error.message:e.status>=500&&(t="Server error. Please try again later."),this.snackBar.open(t,"Close",{duration:5e3,panelClass:["error-snackbar"]})}})}}handleGoogleSignUp(a){this.authService.loginWithGoogle(a).subscribe({next:()=>{this.isProcessingGoogleAuth=!1,this.close.emit(),this.registerSuccess.emit(),this.snackBar.open("Google sign-up successful!","Close",{duration:3e3})},error:e=>{this.isProcessingGoogleAuth=!1;let t="Google authentication failed";e.status===401?t="Google authentication failed. Please try again.":e.status===0?t="Could not connect to server. Please check your connection.":e.status===409?t="Account created successfully! Please try signing in again.":e.error&&typeof e.error=="string"&&e.error.length<100?t=e.error:e.error&&e.error.message&&e.error.message.length<100?t=e.error.message:e.status>=500&&(t="Server error. Please try again later."),(e.status===400||e.error&&(e.error.includes("User not found")||e.error.includes("first time")||e.error.includes("registration")))&&(t="Welcome! Your account has been created. Please try signing in again."),this.snackBar.open(t,"Close",{duration:5e3,panelClass:["error-snackbar"]})}})}onModalClose(){this.isProcessingGoogleAuth=!1,this.close.emit()}static \u0275fac=function(e){return new(e||r)(u($),u(N),u(R),u(D))};static \u0275cmp=k({type:r,selectors:[["app-register-modal"]],inputs:{isOpen:"isOpen"},outputs:{close:"close",switchToLogin:"switchToLogin",registerSuccess:"registerSuccess"},decls:50,vars:11,consts:[[3,"close","isOpen","title"],[3,"ngSubmit","formGroup"],[1,"form-field-container"],[1,"form-row"],["appearance","outline",1,"half-width"],["matInput","","formControlName","firstName","placeholder","First Name"],[4,"ngIf"],["matInput","","formControlName","lastName","placeholder","Last Name"],["appearance","outline",1,"full-width"],["matInput","","formControlName","username","placeholder","Username"],["matInput","","formControlName","email","placeholder","Email","type","email"],["matInput","","formControlName","password","placeholder","Password","type","password"],["matInput","","formControlName","phoneNumber","placeholder","Phone Number"],[1,"form-actions"],["type","submit","mat-raised-button","","color","accent",1,"action-button",3,"disabled"],[1,"divider"],[1,"social-login-container"],[1,"social-login-text"],[1,"google-signin-options"],["type","standard","size","medium","text","signup_with"],[1,"login-link"],["mat-button","","color","primary",1,"link-button",3,"click"]],template:function(e,t){if(e&1&&(n(0,"app-modal",0),c("close",function(){return t.onModalClose()}),n(1,"form",1),c("ngSubmit",function(){return t.onRegister()}),n(2,"div",2)(3,"div",3)(4,"mat-form-field",4)(5,"mat-label"),o(6,"First Name"),i(),d(7,"input",5),p(8,Je,2,0,"mat-error",6),i(),n(9,"mat-form-field",4)(10,"mat-label"),o(11,"Last Name"),i(),d(12,"input",7),p(13,Ke,2,0,"mat-error",6),i()(),n(14,"mat-form-field",8)(15,"mat-label"),o(16,"Username"),i(),d(17,"input",9),p(18,Qe,2,0,"mat-error",6),i(),n(19,"mat-form-field",8)(20,"mat-label"),o(21,"Email"),i(),d(22,"input",10),p(23,Xe,2,0,"mat-error",6)(24,Ze,2,0,"mat-error",6),i(),n(25,"mat-form-field",8)(26,"mat-label"),o(27,"Password"),i(),d(28,"input",11),p(29,et,2,0,"mat-error",6)(30,tt,2,0,"mat-error",6),i(),n(31,"mat-form-field",8)(32,"mat-label"),o(33,"Phone Number (Optional)"),i(),d(34,"input",12),i()(),n(35,"div",13)(36,"button",14),o(37," Register "),i()()(),d(38,"mat-divider",15),n(39,"div",16)(40,"p",17),o(41,"Or sign up with:"),i(),n(42,"div",18),d(43,"asl-google-signin-button",19),i()(),d(44,"mat-divider",15),n(45,"div",20)(46,"p"),o(47,"Already have an account?"),i(),n(48,"button",21),c("click",function(){return t.switchToLogin.emit()}),o(49,"Login now"),i()()()),e&2){let s,g,E,ce,de,pe,ue;m("isOpen",t.isOpen)("title","Register"),l(),m("formGroup",t.registerForm),l(7),m("ngIf",(s=t.registerForm.get("firstName"))==null?null:s.hasError("required")),l(5),m("ngIf",(g=t.registerForm.get("lastName"))==null?null:g.hasError("required")),l(5),m("ngIf",(E=t.registerForm.get("username"))==null?null:E.hasError("required")),l(5),m("ngIf",(ce=t.registerForm.get("email"))==null?null:ce.hasError("required")),l(),m("ngIf",(de=t.registerForm.get("email"))==null?null:de.hasError("email")),l(5),m("ngIf",(pe=t.registerForm.get("password"))==null?null:pe.hasError("required")),l(),m("ngIf",(ue=t.registerForm.get("password"))==null?null:ue.hasError("minlength")),l(6),m("disabled",t.registerForm.invalid)}},dependencies:[w,y,J,Y,z,q,U,H,W,Z,X,K,Q,te,ee,P,T,I,L,A,ne,ie,B],styles:["[_nghost-%COMP%]     .mat-mdc-form-field{display:block}[_nghost-%COMP%]     .mat-mdc-form-field-subscript-wrapper{height:auto!important;position:static!important}[_nghost-%COMP%]     .mat-mdc-form-field-infix{min-height:40px;padding-top:12px!important;padding-bottom:8px!important}[_nghost-%COMP%]     .mat-mdc-text-field-wrapper{background-color:#ffffff0f;height:auto}[_nghost-%COMP%]     .mat-mdc-form-field-flex{margin-top:0}[_nghost-%COMP%]     .mdc-notched-outline{z-index:0}[_nghost-%COMP%]     .mdc-text-field--outlined .mdc-notched-outline__leading, [_nghost-%COMP%]     .mdc-text-field--outlined .mdc-notched-outline__notch, [_nghost-%COMP%]     .mdc-text-field--outlined .mdc-notched-outline__trailing{border-color:#fff3}[_nghost-%COMP%]     .mdc-text-field:not(.mdc-text-field--disabled) .mdc-floating-label{color:#ffffffb3}[_nghost-%COMP%]     .mat-mdc-input-element{color:#fff}[_nghost-%COMP%]     .mat-mdc-form-field-error{margin-top:6px}[_nghost-%COMP%]     .mdc-text-field--outlined:not(.mdc-text-field--disabled).mdc-text-field--focused .mdc-notched-outline__leading, [_nghost-%COMP%]     .mdc-text-field--outlined:not(.mdc-text-field--disabled).mdc-text-field--focused .mdc-notched-outline__notch, [_nghost-%COMP%]     .mdc-text-field--outlined:not(.mdc-text-field--disabled).mdc-text-field--focused .mdc-notched-outline__trailing{border-color:#ff6b6b}.form-field-container[_ngcontent-%COMP%]{margin-bottom:16px}.full-width[_ngcontent-%COMP%]{width:100%}.form-row[_ngcontent-%COMP%]{display:flex;gap:16px;margin-bottom:0}.half-width[_ngcontent-%COMP%]{width:50%}.form-actions[_ngcontent-%COMP%]{display:flex;justify-content:center;margin-top:20px;margin-bottom:16px}[_nghost-%COMP%]     .action-button{width:100%;height:44px;font-weight:500;background-color:#ff6b6b!important;color:#fff!important;border-radius:8px!important;padding:0 16px;box-shadow:0 3px 5px #0003;transition:all .2s ease}[_nghost-%COMP%]     .action-button:hover:not([disabled]){background-color:#ff5252!important;box-shadow:0 4px 8px #0000004d;transform:translateY(-1px)}[_nghost-%COMP%]     .action-button:disabled{background-color:#ff6b6b80!important;color:#fff9!important}[_nghost-%COMP%]     .link-button{color:#ff6b6b!important;font-weight:500}[_nghost-%COMP%]     .link-button:hover{background-color:#ff6b6b1a}.divider[_ngcontent-%COMP%]{margin:16px 0;background-color:#ffffff1a}.social-login-container[_ngcontent-%COMP%]{display:flex;flex-direction:column;align-items:center;margin:16px 0}.social-login-text[_ngcontent-%COMP%]{font-size:14px;color:#ffffffb3;margin-bottom:12px;text-align:center}.google-signin-options[_ngcontent-%COMP%]{display:flex;justify-content:center;width:100%}.login-link[_ngcontent-%COMP%]{display:flex;flex-direction:column;align-items:center;margin-top:8px}.login-link[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{font-size:14px;color:#ffffffb3;margin-bottom:8px}@media (max-width: 500px){.form-row[_ngcontent-%COMP%]{flex-direction:column;gap:0}.half-width[_ngcontent-%COMP%]{width:100%}}"]})};var it=()=>({exact:!0});function nt(r,a){r&1&&(n(0,"button",32)(1,"mat-icon"),o(2,"dashboard"),i(),o(3," Admin Dashboard "),i())}function ot(r,a){if(r&1){let e=M();n(0,"div",33)(1,"button",34),c("click",function(){h(e);let s=f();return _(s.openLoginModal())}),n(2,"mat-icon"),o(3,"person"),i(),o(4," Login "),i(),n(5,"button",35),c("click",function(){h(e);let s=f();return _(s.openRegisterModal())}),o(6," Register "),i()()}}function rt(r,a){r&1&&(n(0,"button",45)(1,"mat-icon"),o(2,"dashboard"),i(),o(3," Admin Dashboard "),i())}function at(r,a){if(r&1){let e=M();n(0,"div",36)(1,"div",37)(2,"span",38),o(3),i(),n(4,"span",39),o(5),i(),n(6,"mat-icon",40),o(7,"arrow_drop_down"),i()(),n(8,"mat-menu",41,0)(10,"button",42)(11,"mat-icon"),o(12,"confirmation_number"),i(),o(13," My Reservations "),i(),p(14,rt,4,0,"button",43),d(15,"mat-divider"),n(16,"button",44),c("click",function(){h(e);let s=f();return _(s.logout())}),n(17,"mat-icon"),o(18,"exit_to_app"),i(),o(19," Sign Out "),i()()()}if(r&2){let e=Se(9),t=f();l(),m("matMenuTriggerFor",e),l(2),O(t.username.charAt(0)),l(2),O(t.username),l(9),m("ngIf",t.isAdmin)}}function st(r,a){if(r&1){let e=M();n(0,"div",46),c("click",function(){h(e);let s=f();return _(s.closeMobileNav())}),i()}r&2&&m("@fadeInOut",void 0)}function lt(r,a){r&1&&(n(0,"small",51),o(1,"Administrator"),i())}function mt(r,a){r&1&&(n(0,"small",51),o(1,"Customer"),i())}function ct(r,a){if(r&1&&(n(0,"div",47)(1,"span",48),o(2),i(),n(3,"div",49)(4,"span",39),o(5),i(),p(6,lt,2,0,"small",50)(7,mt,2,0,"small",50),i()()),r&2){let e=f();l(2),O(e.username.charAt(0)),l(3),O(e.username),l(),m("ngIf",e.isAdmin),l(),m("ngIf",!e.isAdmin)}}function dt(r,a){r&1&&d(0,"mat-divider")}function pt(r,a){if(r&1){let e=M();n(0,"a",52),c("click",function(){h(e);let s=f();return _(s.closeMobileNav())}),n(1,"mat-icon"),o(2,"confirmation_number"),i(),o(3," My Reservations "),i()}}function ut(r,a){if(r&1){let e=M();n(0,"a",53),c("click",function(){h(e);let s=f();return _(s.closeMobileNav())}),n(1,"mat-icon"),o(2,"dashboard"),i(),o(3," Admin Dashboard "),i()}}function ft(r,a){if(r&1){let e=M();ve(0),n(1,"button",54),c("click",function(){h(e);let s=f();return _(s.openRegisterModal())}),n(2,"mat-icon"),o(3,"person_add"),i(),o(4," Register "),i(),n(5,"button",55),c("click",function(){h(e);let s=f();return _(s.openLoginModal())}),n(6,"mat-icon"),o(7,"login"),i(),o(8," Login "),i(),xe()}}function gt(r,a){if(r&1){let e=M();n(0,"button",56),c("click",function(){h(e);let s=f();return s.logout(),_(s.closeMobileNav())}),n(1,"mat-icon"),o(2,"exit_to_app"),i(),o(3," Sign Out "),i()}}var Ve=class r{constructor(a,e,t,s){this.authService=a;this.router=e;this.snackBar=t;this.socialAuthService=s;this.checkScreenSize()}isLoggedIn=!1;isAdmin=!1;username="";mobileNavOpen=!1;isMobile=!1;isLoginModalOpen=!1;isRegisterModalOpen=!1;authStatusSub;onResize(){this.checkScreenSize()}ngOnInit(){this.updateAuthStatus()}ngOnDestroy(){this.authStatusSub&&this.authStatusSub.unsubscribe()}checkScreenSize(){this.isMobile=window.innerWidth<960,!this.isMobile&&this.mobileNavOpen&&(this.mobileNavOpen=!1)}updateAuthStatus(){if(this.isLoggedIn=this.authService.isLoggedIn(),this.isLoggedIn){let a=this.authService.getUserData();a&&(this.username=a.username,this.isAdmin=a.roles.includes("ROLE_ADMIN"))}}openLoginModal(){this.isLoginModalOpen=!0,this.mobileNavOpen&&this.closeMobileNav()}closeLoginModal(){this.isLoginModalOpen=!1}openRegisterModal(){this.isRegisterModalOpen=!0,this.mobileNavOpen&&this.closeMobileNav()}closeRegisterModal(){this.isRegisterModalOpen=!1}switchToRegister(){this.closeLoginModal(),this.openRegisterModal()}switchToLogin(){this.closeRegisterModal(),this.openLoginModal()}onAuthSuccess(){this.updateAuthStatus()}onRegisterSuccess(){this.snackBar.open("Registration successful! Please login.","Close",{duration:3e3})}toggleMobileNav(){this.mobileNavOpen=!this.mobileNavOpen,this.mobileNavOpen?document.body.style.overflow="hidden":document.body.style.overflow=""}closeMobileNav(){this.mobileNavOpen=!1,document.body.style.overflow=""}logout(){this.socialAuthService.signOut(!0).then(()=>{window.google?.accounts.id.disableAutoSelect()}).catch(a=>{console.error("Error signing out from Google:",a)}).finally(()=>{this.authService.logout(),this.isLoggedIn=!1,this.isAdmin=!1,this.username="",localStorage.removeItem("googleToken"),sessionStorage.removeItem("googleToken"),this.clearGoogleCookies(),this.router.navigate(["/"]),this.snackBar.open("You have been logged out","Close",{duration:3e3})})}clearGoogleCookies(){["g_state","gapi-auth","g_csrf_token"].forEach(e=>{document.cookie=`${e}=; expires=Thu, 01 Jan 1970 00:00:00 UTC; path=/;`})}static \u0275fac=function(e){return new(e||r)(u(N),u(G),u(R),u(D))};static \u0275cmp=k({type:r,selectors:[["app-navbar"]],hostBindings:function(e,t){e&1&&c("resize",function(g){return t.onResize(g)},!1,_e)},decls:54,vars:17,consts:[["userMenu","matMenu"],[1,"navbar-container"],[1,"header-toolbar"],[1,"toolbar-container"],["mat-icon-button","","aria-label","Menu",1,"menu-button",3,"click"],["routerLink","/",1,"logo-container"],[1,"logo-text"],[1,"spacer"],[1,"desktop-nav"],["mat-button","","routerLink","/","routerLinkActive","active-link",3,"routerLinkActiveOptions"],["mat-button","","routerLink","/movies","routerLinkActive","active-link"],["mat-button","","routerLink","/admin/dashboard","routerLinkActive","active-link",4,"ngIf"],[1,"auth-container"],["class","auth-actions",4,"ngIf"],[3,"close","switchToRegister","loginSuccess","isOpen"],[3,"close","switchToLogin","registerSuccess","isOpen"],["class","user-profile",4,"ngIf"],["class","mobile-nav-backdrop",3,"click",4,"ngIf"],[1,"mobile-nav"],[1,"mobile-nav-header"],[1,"logo-container"],["mat-icon-button","",3,"click"],[1,"mobile-nav-content"],["class","mobile-nav-user",4,"ngIf"],[4,"ngIf"],[1,"mobile-nav-links"],["routerLink","/",1,"mobile-nav-link",3,"click"],["routerLink","/movies",1,"mobile-nav-link",3,"click"],["class","mobile-nav-link","routerLink","/my-reservations",3,"click",4,"ngIf"],["class","mobile-nav-link","routerLink","/admin/dashboard",3,"click",4,"ngIf"],[1,"mobile-nav-footer"],["mat-raised-button","","color","warn",3,"click",4,"ngIf"],["mat-button","","routerLink","/admin/dashboard","routerLinkActive","active-link"],[1,"auth-actions"],["mat-button","",1,"login-button",3,"click"],["mat-raised-button","","color","accent",1,"register-button",3,"click"],[1,"user-profile"],[1,"user-button",3,"matMenuTriggerFor"],[1,"avatar-circle"],[1,"username"],[1,"dropdown-icon"],[1,"user-menu"],["mat-menu-item","","routerLink","/my-reservations"],["mat-menu-item","","routerLink","/admin/dashboard",4,"ngIf"],["mat-menu-item","",3,"click"],["mat-menu-item","","routerLink","/admin/dashboard"],[1,"mobile-nav-backdrop",3,"click"],[1,"mobile-nav-user"],[1,"avatar-circle","large"],[1,"user-info"],["class","user-role",4,"ngIf"],[1,"user-role"],["routerLink","/my-reservations",1,"mobile-nav-link",3,"click"],["routerLink","/admin/dashboard",1,"mobile-nav-link",3,"click"],["mat-raised-button","","color","accent",1,"mobile-register-btn",3,"click"],["mat-raised-button","",1,"mobile-login-btn",3,"click"],["mat-raised-button","","color","warn",3,"click"]],template:function(e,t){e&1&&(n(0,"div",1)(1,"mat-toolbar",2)(2,"div",3)(3,"button",4),c("click",function(){return t.toggleMobileNav()}),n(4,"mat-icon"),o(5),i()(),n(6,"div",5)(7,"span",6),o(8,"CineReserve"),i()(),d(9,"span",7),n(10,"div",8)(11,"button",9)(12,"mat-icon"),o(13,"home"),i(),o(14," Home "),i(),n(15,"button",10)(16,"mat-icon"),o(17,"movie"),i(),o(18," Browse Movies "),i(),p(19,nt,4,0,"button",11),i(),d(20,"span",7),n(21,"div",12),p(22,ot,7,0,"div",13),n(23,"app-login-modal",14),c("close",function(){return t.closeLoginModal()})("switchToRegister",function(){return t.switchToRegister()})("loginSuccess",function(){return t.onAuthSuccess()}),i(),n(24,"app-register-modal",15),c("close",function(){return t.closeRegisterModal()})("switchToLogin",function(){return t.switchToLogin()})("registerSuccess",function(){return t.onRegisterSuccess()}),i(),p(25,at,20,4,"div",16),i()()(),p(26,st,1,1,"div",17),n(27,"div",18)(28,"div",19)(29,"div",20)(30,"span",6),o(31,"CineReserve"),i()(),n(32,"button",21),c("click",function(){return t.closeMobileNav()}),n(33,"mat-icon"),o(34,"close"),i()()(),d(35,"mat-divider"),n(36,"div",22),p(37,ct,8,4,"div",23)(38,dt,1,0,"mat-divider",24),n(39,"div",25)(40,"a",26),c("click",function(){return t.closeMobileNav()}),n(41,"mat-icon"),o(42,"home"),i(),o(43," Home "),i(),n(44,"a",27),c("click",function(){return t.closeMobileNav()}),n(45,"mat-icon"),o(46,"movie"),i(),o(47," Browse Movies "),i(),p(48,pt,4,0,"a",28)(49,ut,4,0,"a",29),i(),d(50,"mat-divider"),n(51,"div",30),p(52,ft,9,0,"ng-container",24)(53,gt,4,0,"button",31),i()()()()),e&2&&(l(5),O(t.mobileNavOpen?"close":"menu"),l(6),m("routerLinkActiveOptions",ke(16,it)),l(8),m("ngIf",t.isAdmin),l(3),m("ngIf",!t.isLoggedIn),l(),m("isOpen",t.isLoginModalOpen),l(),m("isOpen",t.isRegisterModalOpen),l(),m("ngIf",t.isLoggedIn),l(),m("ngIf",t.mobileNavOpen),l(),be("open",t.mobileNavOpen),l(10),m("ngIf",t.isLoggedIn),l(),m("ngIf",t.isLoggedIn),l(10),m("ngIf",t.isLoggedIn),l(),m("ngIf",t.isAdmin),l(3),m("ngIf",!t.isLoggedIn),l(),m("ngIf",t.isLoggedIn))},dependencies:[w,y,Oe,ye,P,T,V,Pe,we,Le,Te,Ne,Ae,I,j,L,A,Ie,Ee,oe,re],styles:[".navbar-container[_ngcontent-%COMP%]{position:relative}.header-toolbar[_ngcontent-%COMP%]{position:sticky;top:0;z-index:1000;background-color:#3c3b34;color:#fff;box-shadow:0 4px 12px #00000026;height:64px;padding:0}.toolbar-container[_ngcontent-%COMP%]{display:flex;align-items:center;width:100%;max-width:1400px;margin:0 auto;padding:0 24px;height:100%}.logo-container[_ngcontent-%COMP%]{display:flex;align-items:center;cursor:pointer;margin-right:0;min-width:150px}.logo-text[_ngcontent-%COMP%]{font-size:24px;font-weight:500;letter-spacing:.5px;background:linear-gradient(90deg,#ff6b6b,#ffb88c);-webkit-background-clip:text;background-clip:text;-webkit-text-fill-color:transparent;transition:transform .3s ease}.logo-container[_ngcontent-%COMP%]:hover   .logo-text[_ngcontent-%COMP%]{transform:scale(1.05)}.desktop-nav[_ngcontent-%COMP%]{display:flex;align-items:center;justify-content:center}.desktop-nav[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]{margin-right:8px;border-radius:8px;font-weight:500;padding:0 16px;height:40px;transition:all .2s ease}.desktop-nav[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]   mat-icon[_ngcontent-%COMP%]{margin-right:6px;color:#ff6b6b}.active-link[_ngcontent-%COMP%]{background-color:#ff6b6b1f!important;color:#ff6b6b!important}.desktop-nav[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]:hover{background-color:#ffffff1a}.auth-container[_ngcontent-%COMP%]{min-width:150px;display:flex;justify-content:flex-end;align-items:center}.auth-actions[_ngcontent-%COMP%]{display:flex;align-items:center;justify-content:flex-end;width:100%}.spacer[_ngcontent-%COMP%]{flex:1 1 auto}.auth-actions[_ngcontent-%COMP%]{display:flex;align-items:center}.login-button[_ngcontent-%COMP%]{margin-right:8px;font-weight:500}.login-button[_ngcontent-%COMP%]   mat-icon[_ngcontent-%COMP%]{margin-right:4px;color:#ff6b6b}.register-button[_ngcontent-%COMP%]{font-weight:500;background-color:#ff6b6b!important;color:#fff!important;border-radius:8px;padding:0 16px;height:40px}.user-profile[_ngcontent-%COMP%]{display:flex;align-items:center}.user-button[_ngcontent-%COMP%]{display:flex;align-items:center;height:36px;border-radius:18px;padding:0 8px 0 2px;border:1px solid rgba(255,255,255,.2);transition:all .2s ease;background-color:#ffffff14;min-height:0;line-height:normal;cursor:pointer}  .user-button .mat-mdc-button-touch-target{height:100%!important}  .mat-mdc-button.user-button{padding:0 8px 0 2px;height:36px}.user-button[_ngcontent-%COMP%]:hover{background-color:#ffffff1a;border-color:#ffffff4d}.dropdown-icon[_ngcontent-%COMP%]{color:#ffffffb3;font-size:18px;height:18px;width:18px;margin-top:-2px}.avatar-circle[_ngcontent-%COMP%]{display:flex;align-items:center;justify-content:center;width:32px;height:32px;border-radius:50%;background-color:#ff6b6b;color:#fff;text-transform:uppercase;font-weight:600;font-size:14px;margin-right:8px;line-height:1}.avatar-circle.large[_ngcontent-%COMP%]{width:48px;height:48px;font-size:20px}.username[_ngcontent-%COMP%]{font-weight:500;margin-right:4px;font-size:14px}  .mat-mdc-menu-panel{background-color:#35342e!important;border-radius:12px!important;overflow:hidden;padding:0!important}  .mat-mdc-menu-item{color:#fff!important;font-weight:500}  .mat-mdc-menu-item mat-icon{color:#ff6b6b!important}  .mat-mdc-menu-item:hover:not([disabled]){background-color:#ff6b6b1a!important}.menu-button[_ngcontent-%COMP%]{display:none;margin-right:16px}.menu-button[_ngcontent-%COMP%]   mat-icon[_ngcontent-%COMP%]{color:#fff}.mobile-nav-backdrop[_ngcontent-%COMP%]{position:fixed;top:0;left:0;width:100%;height:100%;background-color:#00000080;z-index:1000}.mobile-nav[_ngcontent-%COMP%]{position:fixed;top:0;left:-300px;width:280px;height:100%;background-color:#35342e;z-index:1001;box-shadow:4px 0 20px #0000004d;transition:left .3s ease;overflow-y:auto}.mobile-nav.open[_ngcontent-%COMP%]{left:0}.mobile-nav-header[_ngcontent-%COMP%]{display:flex;align-items:center;justify-content:space-between;padding:16px;background-color:#3c3b34}.mobile-nav-user[_ngcontent-%COMP%]{display:flex;align-items:center;padding:24px 16px}.user-info[_ngcontent-%COMP%]{display:flex;flex-direction:column;margin-left:16px}.user-role[_ngcontent-%COMP%]{opacity:.7;margin-top:4px;font-size:12px;color:#ffffffb3}.mobile-nav-content[_ngcontent-%COMP%]{display:flex;flex-direction:column;height:calc(100% - 64px)}.mobile-nav-links[_ngcontent-%COMP%]{padding:16px 0;flex:1}.mobile-nav-link[_ngcontent-%COMP%]{display:flex;align-items:center;padding:12px 16px;color:#fff;text-decoration:none;font-weight:500;transition:background-color .2s ease}.mobile-nav-link[_ngcontent-%COMP%]:hover{background-color:#ff6b6b1a}.mobile-nav-link[_ngcontent-%COMP%]   mat-icon[_ngcontent-%COMP%]{margin-right:16px;color:#ff6b6b}.mobile-nav-footer[_ngcontent-%COMP%]{padding:16px;display:flex;flex-direction:column;gap:12px}.mobile-register-btn[_ngcontent-%COMP%], .mobile-login-btn[_ngcontent-%COMP%]{width:100%;height:44px}@media (max-width: 960px){.desktop-nav[_ngcontent-%COMP%]{display:none}.menu-button[_ngcontent-%COMP%]{display:block}.logo-container[_ngcontent-%COMP%], .auth-container[_ngcontent-%COMP%]{min-width:0}}@media (max-width: 600px){.register-button[_ngcontent-%COMP%]{display:none}.user-button[_ngcontent-%COMP%]{padding:0 6px;height:32px}.avatar-circle[_ngcontent-%COMP%]{width:28px;height:28px;font-size:12px;margin-right:4px}.username[_ngcontent-%COMP%]{display:none}.toolbar-container[_ngcontent-%COMP%]{padding:0 12px}}"],data:{animation:[F("fadeInOut",[S(":enter",[b({opacity:0}),C("300ms ease-in",b({opacity:1}))]),S(":leave",[C("200ms ease-out",b({opacity:0}))])])]}})};export{Ve as a};
