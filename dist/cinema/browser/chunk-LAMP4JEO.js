import{a as pe}from"./chunk-AF5GEKCT.js";import{b as L}from"./chunk-HGZD7DPT.js";import{c as de}from"./chunk-3TUISTHT.js";import"./chunk-D4UZFIV5.js";import{a as te,b as ie}from"./chunk-JQMIOQDN.js";import{d as ce,e as le}from"./chunk-A5FMPQVA.js";import{b as re,c as ne}from"./chunk-BAFH5YR6.js";import{D as me,E as se,c as U,e as _,g as W,h as q,k as z,n as H,o as J,s as K,u as Q,v as ae,z as oe}from"./chunk-XZSR4YHY.js";import"./chunk-ROUTVLYY.js";import{o as O,s as A}from"./chunk-A4IL2YBM.js";import{a as X,c as Y,e as Z,g as ee}from"./chunk-PQBGQV3H.js";import{e as k,f as R,ga as V,ha as j,i as N,k as w,l as D,x as $,y as G}from"./chunk-DWWDMUIZ.js";import{Db as s,H as h,M,Mb as a,Nb as r,Ob as p,Sb as E,Wb as F,X as C,Xb as c,cb as S,fb as o,gc as m,hc as y,ic as f,jc as T,kb as v,p as g,qa as x,ra as I,rb as b,rc as u,tc as B,uc as P,wb as l}from"./chunk-HQVUQXPE.js";function ue(t,i){t&1&&(a(0,"div",15),p(1,"mat-spinner",16),r())}function _e(t,i){t&1&&(a(0,"div",17)(1,"mat-icon"),m(2,"search_off"),r(),a(3,"p"),m(4,"No results found for your search"),r()())}function ge(t,i){if(t&1&&p(0,"img",34),t&2){let e=c().$implicit,n=c(2);s("src",n.getPosterPath(e),S)("alt",e.title)}}function he(t,i){t&1&&(a(0,"div",35)(1,"mat-icon"),m(2,"movie"),r()())}function Me(t,i){if(t&1&&(a(0,"span",36)(1,"mat-icon",37),m(2,"calendar_today"),r(),m(3),u(4,"date"),r()),t&2){let e=c().$implicit;o(3),f(" ",B(4,1,e.releaseDate,"yyyy")," ")}}function Ce(t,i){if(t&1&&(a(0,"span",38)(1,"mat-icon",39),m(2,"star"),r(),m(3),r()),t&2){let e=c().$implicit;o(3),f(" ",e.voteAverage," / 10 ")}}function xe(t,i){if(t&1&&(a(0,"span",42),m(1),r()),t&2){let e=i.$implicit,n=c(4);o(),f(" ",n.getGenreName(e)," ")}}function Ie(t,i){if(t&1&&(a(0,"div",40),l(1,xe,2,1,"span",41),r()),t&2){let e=c().$implicit;o(),s("ngForOf",e.genreIds.slice(0,3))}}function Se(t,i){if(t&1&&(a(0,"p",43),m(1),u(2,"slice"),r()),t&2){let e=c().$implicit;o(),T(" ",P(2,2,e.overview,0,150),"",e.overview.length>150?"...":""," ")}}function be(t,i){t&1&&p(0,"mat-spinner",44)}function Ee(t,i){if(t&1){let e=E();a(0,"mat-card",20)(1,"div",21),l(2,ge,1,2,"img",22)(3,he,3,0,"div",23),r(),a(4,"mat-card-content",24)(5,"h3",25),m(6),r(),a(7,"div",26),l(8,Me,5,4,"span",27)(9,Ce,4,1,"span",28),r(),l(10,Ie,2,1,"div",29)(11,Se,3,6,"p",30),r(),a(12,"mat-card-actions",31)(13,"button",32),F("click",function(){let d=x(e).$implicit,fe=c(2);return I(fe.importMovie(d.id))}),a(14,"mat-icon"),m(15,"add"),r(),m(16," Import "),l(17,be,1,0,"mat-spinner",33),r()()()}if(t&2){let e=i.$implicit,n=c(2);o(2),s("ngIf",n.getPosterPath(e)),o(),s("ngIf",!n.getPosterPath(e)),o(3),y(e.title),o(2),s("ngIf",e.releaseDate),o(),s("ngIf",e.voteAverage),o(),s("ngIf",e.genreIds&&e.genreIds.length>0),o(),s("ngIf",e.overview),o(2),s("disabled",n.importing),o(4),s("ngIf",n.importing)}}function Fe(t,i){if(t&1&&(a(0,"div",18),l(1,Ee,18,9,"mat-card",19),r()),t&2){let e=c();o(),s("ngForOf",e.searchResults)}}function ye(t,i){t&1&&(a(0,"div",45),p(1,"mat-spinner",46),a(2,"p"),m(3,"Importing movie..."),r()())}var ve=class t{constructor(i,e,n,d){this.fb=i;this.movieService=e;this.router=n;this.snackBar=d;this.searchForm=this.fb.group({searchTerm:["",[_.required,_.minLength(2)]]})}searchForm;searchResults=[];searching=!1;importing=!1;genres={28:"Acci\xF3n",12:"Aventura",16:"Animaci\xF3n",35:"Comedia",80:"Crimen",99:"Documental",18:"Drama",10751:"Familia",14:"Fantas\xEDa",36:"Historia",27:"Terror",10402:"M\xFAsica",9648:"Misterio",10749:"Romance",878:"Ciencia ficci\xF3n",10770:"Pel\xEDcula de TV",53:"Suspense",10752:"Guerra",37:"Western"};ngOnInit(){this.searchForm.get("searchTerm")?.valueChanges.pipe(h(500),M(),C(i=>i&&i.length>=2?(this.searching=!0,this.movieService.searchMovies(i)):(this.searchResults=[],g([])))).subscribe({next:i=>{this.searchResults=i,this.searching=!1},error:i=>{this.searching=!1,this.snackBar.open("Error al buscar pel\xEDculas: "+i.message,"Cerrar",{duration:5e3})}})}getGenreName(i){return this.genres[i]||"Otro"}getPosterPath(i){let e="https://image.tmdb.org/t/p/w500",n=i.posterPath||i.poster_path||i.posterUrl;return n?n.startsWith("http")?n:n.startsWith("/")?`${e}${n}`:n:null}importMovie(i){this.importing=!0,this.movieService.createMovieFromTMDB(i).subscribe({next:e=>{this.importing=!1,this.snackBar.open(`Pel\xEDcula "${e.title}" importada con \xE9xito`,"Cerrar",{duration:3e3}),this.router.navigate(["/admin/movies"])},error:e=>{this.importing=!1,this.snackBar.open("Error al importar pel\xEDcula: "+e.message,"Cerrar",{duration:5e3})}})}static \u0275fac=function(e){return new(e||t)(v(K),v(pe),v($),v(re))};static \u0275cmp=b({type:t,selectors:[["app-movie-create"]],decls:23,vars:5,consts:[[1,"movie-create-container"],[1,"dashboard-title-container"],[1,"dashboard-title-marker"],[1,"dashboard-title"],[1,"action-bar"],["mat-raised-button","","routerLink","/admin/movies",1,"accent-bg"],[1,"search-card"],[1,"search-form",3,"formGroup"],["appearance","outline",1,"search-field"],["matInput","","formControlName","searchTerm","placeholder","Movie title"],["matSuffix",""],["class","loading-spinner",4,"ngIf"],["class","no-results",4,"ngIf"],["class","search-results-grid",4,"ngIf"],["class","importing-spinner",4,"ngIf"],[1,"loading-spinner"],["diameter","40",1,"accent-spinner"],[1,"no-results"],[1,"search-results-grid"],["class","movie-card",4,"ngFor","ngForOf"],[1,"movie-card"],[1,"poster-container"],["class","movie-poster",3,"src","alt",4,"ngIf"],["class","no-poster",4,"ngIf"],[1,"movie-card-content"],[1,"movie-title"],[1,"movie-metadata"],["class","release-date",4,"ngIf"],["class","vote-average",4,"ngIf"],["class","genres-container",4,"ngIf"],["class","movie-overview",4,"ngIf"],["align","end"],["mat-raised-button","",1,"accent-bg",3,"click","disabled"],["diameter","20","class","button-spinner",4,"ngIf"],[1,"movie-poster",3,"src","alt"],[1,"no-poster"],[1,"release-date"],[1,"meta-icon"],[1,"vote-average"],[1,"meta-icon","star-icon"],[1,"genres-container"],["class","genre-chip",4,"ngFor","ngForOf"],[1,"genre-chip"],[1,"movie-overview"],["diameter","20",1,"button-spinner"],[1,"importing-spinner"],[1,"accent-spinner"]],template:function(e,n){if(e&1&&(a(0,"div",0)(1,"div",1),p(2,"div",2),a(3,"h1",3),m(4,"Add Movie"),r()(),a(5,"div",4)(6,"button",5)(7,"mat-icon"),m(8,"arrow_back"),r(),m(9," Back to Movie Management "),r()(),a(10,"mat-card",6)(11,"mat-card-content")(12,"form",7)(13,"mat-form-field",8)(14,"mat-label"),m(15,"Search for a movie"),r(),p(16,"input",9),a(17,"mat-icon",10),m(18,"search"),r()()(),l(19,ue,2,0,"div",11)(20,_e,5,0,"div",12),r()(),l(21,Fe,2,1,"div",13)(22,ye,4,0,"div",14),r()),e&2){let d;o(12),s("formGroup",n.searchForm),o(7),s("ngIf",n.searching),o(),s("ngIf",!n.searching&&n.searchResults.length===0&&((d=n.searchForm.get("searchTerm"))==null?null:d.value)),o(),s("ngIf",n.searchResults.length>0),o(),s("ngIf",n.importing)}},dependencies:[D,k,R,w,N,Q,z,U,W,q,H,J,se,me,ae,oe,le,ce,A,O,ee,X,Z,Y,ie,te,j,V,de,L,ne,G],encapsulation:2})};export{ve as MovieCreateComponent};
